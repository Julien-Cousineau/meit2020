# Download

# az storage blob download --container-name ecmeit --name MEIT_2015_arctic_emissions --file data/csv/raw/zip/2015_arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2016_Arctic_Emissions --file data/csv/raw/zip/2016_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2017_arctic_Emissions --file data/csv/raw/zip/2017_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2018_arctic_Emissions --file data/csv/raw/zip/2018_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2019_arctic_Emissions --file data/csv/raw/zip/2019_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2020_arctic_Emissions --file data/csv/raw/zip/2020_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name MEIT_2021_arctic_emissions --file data/csv/raw/zip/2021_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2022_arctic_Emissions --file data/csv/raw/zip/2022_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2023_arctic_Emissions --file data/csv/raw/zip/2023_Arctic_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY

# az storage blob download --container-name ecmeit --name MEIT_2015_pacific_emissions --file data/csv/raw/zip/2015_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2016_pacific_Emissions --file data/csv/raw/zip/2016_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2017_pacific_Emissions --file data/csv/raw/zip/2017_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2018_pacific_Emissions --file data/csv/raw/zip/2018_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2019_pacific_Emissions --file data/csv/raw/zip/2019_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2020_pacific_Emissions --file data/csv/raw/zip/2020_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2021_pacific_Emissions --file data/csv/raw/zip/2021_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2022_pacific_Emissions --file data/csv/raw/zip/2022_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2023_pacific_Emissions --file data/csv/raw/zip/2023_pacific_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY

# az storage blob download --container-name ecmeit --name MEIT_2015_east_emissions --file data/csv/raw/zip/2015_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2016_east_Emissions --file data/csv/raw/zip/2016_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2017_east_Emissions --file data/csv/raw/zip/2017_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2018_east_Emissions --file data/csv/raw/zip/2018_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2019_east_Emissions --file data/csv/raw/zip/2019_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2020_east_Emissions --file data/csv/raw/zip/2020_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2021_east_Emissions --file data/csv/raw/zip/2021_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2022_east_Emissions --file data/csv/raw/zip/2022_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
# az storage blob download --container-name ecmeit --name 2023_east_Emissions --file data/csv/raw/zip/2023_east_Emissions.zip --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY


# Unzip

# cd data/csv/raw/zip

# unzip 2015_arctic_Emissions.zip
# unzip 2016_Arctic_Emissions.zip
# unzip 2017_Arctic_Emissions.zip
# unzip 2018_Arctic_Emissions.zip
# unzip 2019_Arctic_Emissions.zip
# unzip 2020_Arctic_Emissions.zip
# unzip 2021_Arctic_Emissions.zip
# unzip 2022_Arctic_Emissions.zip
# unzip 2023_Arctic_Emissions.zip

# unzip 2015_pacific_Emissions.zip
# unzip 2016_pacific_Emissions.zip
# unzip 2017_pacific_Emissions.zip
# unzip 2018_pacific_Emissions.zip
# unzip 2019_pacific_Emissions.zip
# unzip 2020_pacific_Emissions.zip
# unzip 2021_pacific_Emissions.zip
# unzip 2022_pacific_Emissions.zip
# unzip 2023_pacific_Emissions.zip

# unzip 2015_east_Emissions.zip
# unzip 2016_east_Emissions.zip
# unzip 2017_east_Emissions.zip
# unzip 2018_east_Emissions.zip
# unzip 2019_east_Emissions.zip
# unzip 2020_east_Emissions.zip
# unzip 2021_east_Emissions.zip
# unzip 2022_east_Emissions.zip
# unzip 2023_east_Emissions.zip


function run(){
    FILE=$1    
    NAME=$2           
    
    NEWFILE=data/csv/$NAME.2.csv
    ZIPFILE=data/csv/$NAME.2.zip
    AZFILE=UPLOAD2024_v2/$NAME.2.zip
    if [ ! -f $ZIPFILE ]
    then
        node process/index.js $FILE $NEWFILE true --max-old-space-size=4000
        zip $ZIPFILE $NEWFILE
        rm $NEWFILE
        az storage blob upload --container-name ecmeit --name $AZFILE --file $ZIPFILE --account-name $AZURE_STORAGE_ACCOUNT --account-key $AZURE_STORAGE_ACCESS_KEY
        rm $ZIPFILE
    
    fi        
}
# Arctic
# run data/csv/raw/zip/MEIT_2015_arctic_emissionsFUEL.csv arctic_2015
# run data/csv/raw/zip/MEIT_2016_arctic_emissions_2024-07-16.csv arctic_2016
# run data/csv/raw/zip/MEIT_2017_arctic_emissions_2024-07-15.csv arctic_2017
# run data/csv/raw/zip/MEIT_2018_arctic_emissions_2024-07-15.csv arctic_2018
# run data/csv/raw/zip/MEIT_2019_arctic_emissions_2024-07-15.csv arctic_2019
# run data/csv/raw/zip/MEIT_2020_arctic_emissions_2024-07-15.csv arctic_2020
run data/csv/raw/zip/MEIT_2021_arctic_emissions.csv arctic_2021
# run data/csv/raw/zip/MEIT_2022_arctic_emissions_2024-07-15.csv arctic_2022
# run data/csv/raw/zip/MEIT_2023_arctic_emissions_2024-07-15.csv arctic_2023

# Pacific
# run data/csv/raw/zip/MEIT_2015_pacific_emissionsFUEL.csv pacific_2015
# run data/csv/raw/zip/MEIT_2016_pacific_emissions_2024-07-15.csv pacific_2016
# run data/csv/raw/zip/MEIT_2017_pacific_emissions_2024-07-15.csv pacific_2017
# run data/csv/raw/zip/MEIT_2018_pacific_emissions_2024-07-15.csv pacific_2018
# run data/csv/raw/zip/MEIT_2019_pacific_emissions_2024-07-15.csv pacific_2019
# run data/csv/raw/zip/MEIT_2020_pacific_emissions_2024-07-15.csv pacific_2020
# run data/csv/raw/zip/MEIT_2021_pacific_emissions_2024-07-15.csv pacific_2021
# run data/csv/raw/zip/MEIT_2022_pacific_emissions_2024-07-15.csv pacific_2022
# run data/csv/raw/zip/MEIT_2023_pacific_emissions_2024-07-15.csv pacific_2023

# East
# run data/csv/raw/zip/MEIT_2015_east_emissionsFUEL.csv east_2015
# run data/csv/raw/zip/MEIT_2016_east_emissions_2024-07-15.csv east_2016
# run data/csv/raw/zip/MEIT_2017_east_emissions_2024-07-15.csv east_2017
# run data/csv/raw/zip/MEIT_2018_east_emissions_2024-07-15.csv east_2018
# run data/csv/raw/zip/MEIT_2019_east_emissions_2024-07-15.csv east_2019
# run data/csv/raw/zip/MEIT_2020_east_emissions_2024-07-15.csv east_2020
# run data/csv/raw/zip/MEIT_2021_east_emissions_2024-07-15.csv east_2021
# run data/csv/raw/zip/MEIT_2022_east_emissions_2024-07-15.csv east_2022
# run data/csv/raw/zip/MEIT_2023_east_emissions_2024-07-15.csv east_2023


# run data/csv/raw/2021/MEIT_2021_east_emissions_2024-03-27.csv "2021" east_2021
# run data/csv/raw/2021/MEIT_2021_pacific_emissions_2024-03-27.csv "2021" pacific_2021

# run data/csv/raw/zip/MEIT_2022_arctic_emissions_2024-03-27.csv 2022 arctic_2022
# run data/csv/raw/zip/MEIT_2022_east_emissions_2024-03-27.csv 2022 east_2022
# run data/csv/raw/zip/MEIT_2022_pacific_emissions_2024-03-27.csv 2022 pacific_2022


#run data/csv/raw/zip/MEIT_2023_arctic_emissions_2024-03-25.csv 2023 arctic_2023
#run data/csv/raw/zip/MEIT_2023_east_emissions_2024-03-26.csv 2023 east_2023
#run data/csv/raw/zip/MEIT_2023_pacific_emissions_2024-03-25.csv 2023 pacific_2023



# Test
# node upload/data2db.js 0 2015
# node upload/data2db.js 0 2016
# node upload/data2db.js 0 2017
# node upload/data2db.js 0 2018
# node upload/data2db.js 0 2019
# node upload/data2db.js 0 2020 1
# node upload/data2db.js 0 2021
# node upload/data2db.js 0 2022
# node upload/data2db.js 0 2023
# node upload/data2db.js 1 2021 MEIT_Arctic/arctic_2015.csv
# node upload/data2db.js 1 2016 MEIT_Arctic/arctic_2016.csv
# node upload/data2db.js 1 2017 MEIT_Arctic/arctic_2017.csv
# node upload/data2db.js 1 2018 MEIT_Arctic/arctic_2018.csv
# node upload/data2db.js 1 2019 MEIT_Arctic/arctic_2019.csv
# node upload/data2db.js 1 2020 MEIT_Arctic/arctic_2020.csv
# node upload/data2db.js 2 2015 MEIT_Arctic/arctic_2015.2.csv
